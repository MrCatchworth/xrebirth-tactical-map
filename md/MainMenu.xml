<?xml version="1.0" encoding="iso-8859-1" ?>
<diff>
    <replace sel="//cue[@name='SectionHandler_Nav']/actions//open_conversation_menu[@menu='MapMenu']">
        <do_all>
            <do_if value="@event.param3 != null and (not event.param3.{1})">
                <set_value name="$hasMode" exact="@event.param3.{7} != null" />
            </do_if>
            <do_else>
                <set_value name="$hasMode" exact="@event.param2.{7} != null" />
            </do_else>
            <!-- <debug_text text="'Opening map - has mode = ' + $hasMode" filter="general" /> -->
            <do_if value="$hasMode">
                <open_conversation_menu menu="MapMenu" param="event.param2" param2="event.param3" />
            </do_if>
            <do_else>
                <open_conversation_menu menu="MeJ_TacticalMapMenu" param="event.param2" param2="event.param3" />
            </do_else>
        </do_all>
    </replace>
    
    <replace sel="//cue[@name='SectorMapStarted']/actions/do_if/open_conversation_menu[@menu='MapMenu']/@menu">MeJ_TacticalMapMenu</replace>
    <replace sel="//cue[@name='SectorMapStarted']/actions/do_else/do_if/open_conversation_menu[@menu='MapMenu']/@menu">MeJ_TacticalMapMenu</replace>
    <replace sel="//cue[@name='SectorMapStarted']/actions/do_else/do_else/open_conversation_menu[@menu='MapMenu']/@menu">MeJ_TacticalMapMenu</replace>
    
    <replace sel="//cue[@name='ZoneMapStarted']/actions/do_if/open_conversation_menu[@menu='MapMenu']/@menu">MeJ_TacticalMapMenu</replace>
    <replace sel="//cue[@name='ZoneMapStarted']/actions/do_else/do_if/open_conversation_menu[@menu='MapMenu']/@menu">MeJ_TacticalMapMenu</replace>
    <replace sel="//cue[@name='ZoneMapStarted']/actions/do_else/do_else/open_conversation_menu[@menu='MapMenu']/@menu">MeJ_TacticalMapMenu</replace>
</diff>